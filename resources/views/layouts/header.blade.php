<header class="bg-white dark:bg-[#1a3a52] shadow-sm border-b border-gray-200 dark:border-gray-700 transition-colors duration-300">
  <!-- Top Bar -->
  <div class="bg-gray-50 dark:bg-[#0f2837] text-sm text-gray-600 dark:text-gray-300 flex justify-between items-center px-4 md:px-8 py-2 border-b border-gray-200 dark:border-gray-700 transition-colors duration-300">
    <div class="flex items-center px-6 space-x-2">
      <span class="text-gray-700 dark:text-gray-200">Selamat Datang</span>

      <!-- Dark Mode Toggle -->
      <label class="relative inline-flex items-center cursor-pointer">
        <input type="checkbox" id="dark-mode-toggle" class="sr-only peer">
        <div class="w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-500 rounded-full peer dark:bg-gray-600 
          peer-checked:after:translate-x-full peer-checked:after:border-white 
          after:content-[''] after:absolute after:top-[2px] after:left-[2px] 
          after:bg-white after:border-gray-300 after:border after:rounded-full 
          after:h-5 after:w-5 after:transition-all dark:border-gray-600 
          peer-checked:bg-blue-600">
        </div>
      </label>
    </div>

    <!-- Social + Hubungi Kami -->
    <div class="hidden sm:flex items-center space-x-4">
      <!-- Icons -->
      <a href="https://www.tiktok.com/@rsudbandungkiwari?is_from_webapp=1&sender_device=pc" class="text-gray-600 dark:text-gray-300 hover:text-red dark:hover:text-white transition">
        <!-- Tiktok -->
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 448 512">
          <path d="M448 209.9a210.1 210.1 0 0 1 -122.8-39.3V349.4A162.6 162.6 0 1 1 185 188.3V278.2a74.6 74.6 0 1 0 52.2 71.2V0l88 0a121.2 121.2 0 0 0 1.9 22.2h0A122.2 122.2 0 0 0 381 102.4a121.4 121.4 0 0 0 67 20.1z" />
        </svg>
      </a>
      <a href="https://www.facebook.com/rsudbandungkiwari/" class="text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition">
        <!-- Facebook -->
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path d="M24 12.073C24 5.446 18.627 0 12 0S0 5.446 0 12.073C0 18.063 4.388 23.027 10.125 23.927v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
        </svg>
      </a>
      <a href="https://www.whatsapp.com/channel/0029Vay0gBUKWEKyrF349r2k?utm_source=ig&utm_medium=social&utm_content=link_in_bio&fbclid=PAZXh0bgNhZW0CMTEAc3J0YwZhcHBfaWQMMjU2MjgxMDQwNTU4AAGnxFojfaQEISBbOa5o5t7dBLh6bBhIxRZGEttN6hTCsbyIVFHtkjBeDmQtBxI_aem_fArJaa8lfBnOZ2_Tq-dQZg" class="text-gray-600 dark:text-gray-300 hover:text-green-600 dark:hover:text-green-400 transition">
        <!-- WhatsApp -->
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347"/>
        </svg>
      </a>
      <a href="https://youtube.com/@rsudbdgkiwari?si=trOZS10_qKROVPLl" class="text-gray-600 dark:text-gray-300 hover:text-red-600 dark:hover:text-red-400 transition">
        <!-- YouTube -->
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
        </svg>
      </a>
      <a href="https://www.instagram.com/rsudbandungkiwari?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw== " class="text-gray-600 dark:text-gray-300 hover:text-pink-600 dark:hover:text-pink-400 transition">
        <!-- Instagram -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <rect x="3" y="3" width="18" height="18" rx="5" ry="5"/>
          <circle cx="12" cy="12" r="4"/>
          <circle cx="17" cy="7" r="1.5"/>
        </svg>
      </a>
      <span class="text-gray-400 dark:text-gray-600">|</span>
      <a href="#" class="text-gray-700 dark:text-gray-300 hover:underline transition px-3">Hubungi Kami</a>
    </div>
  </div>
 
  <!-- Main Navigation -->
  <div class="bg-white dark:bg-[#232F67] transition-colors duration-300">
    <div class="container mx-auto flex justify-between items-center px-6 py-3">
      <!-- Logo -->
     <a href="/" class="flex items-center space-x-3">
      <div class="flex items-center space-x-3">
        <img src="{{ asset('images/asset_1_new.png') }}" alt="Logo RSUD Bandung Kiwari" class="h-14 dark:brightness-110">
      </div>
        <nav class="hidden md:flex flex-1 items-center justify-center space-x-8 text-gray-700 dark:text-gray-200 font-medium text-sm">
            <a href="/" class="hover:text-blue-700 dark:hover:text-blue-400 transition inline-flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V10.5z" />
              </svg>
              <span>Beranda</span>
            </a>
            <a href="{{ url('/#informasi') }}" class="hover:text-blue-700 dark:hover:text-blue-400 transition inline-flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z" />
              </svg>
              <span>Informasi</span>
            </a>
            <a href="{{ route('jadwal') }}" class="hover:text-blue-700 dark:hover:text-blue-400 transition inline-flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z" />
              </svg>
              <span>Jadwal Dokter</span>
            </a>
            <a href="{{ url('/#syarat') }}" class="hover:text-blue-700 dark:hover:text-blue-400 transition inline-flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6M9 16h6M12 8h.01M7 21h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z" />
              </svg>
              <span>S&amp;K</span>
            </a>
        </nav>
      <!-- Hamburger for Mobile -->
      <button id="menu-toggle" class="md:hidden text-gray-700 dark:text-gray-200 focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>

      <!-- Account / Login / Back Button -->
      <div class="hidden md:block">
        @if(session('user'))
        <div class="relative">
          <button id="account-button" aria-haspopup="true" aria-expanded="false" class="flex items-center gap-2 px-2 py-1 rounded-md focus:outline-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-[#2c3e8f] dark:text-white" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 12c2.761 0 5-2.239 5-5s-2.239-5-5-5-5 2.239-5 5 2.239 5 5 5zm0 2c-4.418 0-8 1.79-8 4v2h16v-2c0-2.21-3.582-4-8-4z"/>
            </svg>
          </button>

          <div id="account-dropdown" class="hidden absolute right-0 mt-2 w-72 bg-white dark:bg-[#0f1724] border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50">
            @php $u = session('user') ?? []; @endphp
            <div class="p-0">
              <div class="bg-gradient-to-r from-[#2c3e8f] to-[#1a6fb3] text-white rounded-t-lg p-4 flex items-center gap-3">
                <div class="w-12 h-12 flex-shrink-0 rounded-full bg-white/20 flex items-center justify-center text-lg font-semibold text-white">
                  {{ strtoupper(substr($u['nama'] ?? $u['nama_lengkap'] ?? '-', 0, 1)) }}
                </div>
                <div>
                  <div class="font-semibold text-white">{{ $u['nama'] ?? $u['nama_lengkap'] ?? '-' }}</div>
                  <div class="text-xs text-white/80">No RM: {{ $u['no_rm'] ?? '-' }}</div>
                </div>
              </div>

              <div class="p-3 text-sm text-gray-700 dark:text-gray-300">
                <a href="{{ route('pendaftaran-pasien-lama.history') }}" class="block w-full text-center text-gray-800 dark:text-gray-200 bg-gray-100 dark:bg-[#0b1320] hover:bg-gray-200 rounded px-3 py-2 font-medium">Lihat status reservasi</a>
              </div>
            </div>
            <div class="border-t border-gray-100 dark:border-gray-700 p-3">
              <form action="{{ route('logout') }}" method="POST">
                @csrf
                <button type="submit" class="w-full text-center text-white bg-green-600 hover:bg-green-700 px-3 py-2 rounded-md font-semibold">Logout</button>
              </form>
            </div>
          </div>
        </div>
        @else
        @if(request()->routeIs('home'))
        <a href="{{ url('/#loginSection') }}" class="text-white px-6 py-2 rounded-md font-semibold bg-[#2c3e8f] hover:bg-[#233170] dark:bg-teal-600 dark:hover:bg-teal-700 transition shadow-sm">
          DAFTAR / LOGIN
        </a>
        @else
        <a href="#" onclick="window.history.back(); return false;" class="text-white px-6 py-2 rounded-md font-semibold bg-[#2c3e8f] hover:bg-[#233170] dark:bg-teal-600 dark:hover:bg-teal-700 transition shadow-sm">
          KEMBALI
        </a>
        @endif
        @endif
      </div>
    </div>
  </div>
</header>

<!-- Mobile Sidebar -->
<div id="mobile-menu" aria-hidden="true" class="fixed inset-y-0 left-0 w-64 sm:w-64 bg-blue-700 text-white transform -translate-x-full transition-transform duration-300 ease-in-out z-50">
  <div class="flex justify-between items-center p-4 border-b border-blue-500">
    <h2 class="text-lg font-semibold">Menu</h2>
    <button id="close-menu">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </div>
  <nav class="p-4 space-y-4">
    <a href="/" class="block hover:bg-blue-600 rounded-lg px-3 py-2 inline-flex items-center gap-3">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V10.5z" />
      </svg>
      <span>Beranda</span>
    </a>
    <a href="{{ url('/#informasi') }}" class="block hover:bg-blue-600 rounded-lg px-3 py-2 inline-flex items-center gap-3">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z" />
      </svg>
      <span>Informasi</span>
    </a>
    <a href="{{ route('jadwal') }}" class="block hover:bg-blue-600 rounded-lg px-3 py-2 inline-flex items-center gap-3">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z" />
      </svg>
      <span>Jadwal Dokter</span>
    </a>
    <a href="{{ url('/#syarat') }}" class="block hover:bg-blue-600 rounded-lg px-3 py-2 inline-flex items-center gap-3">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6M9 16h6M12 8h.01M7 21h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z" />
      </svg>
      <span>S&amp;K</span>
    </a>
    @if(request()->routeIs('home'))
    <a href="#" class="block hover:bg-blue-600 rounded-lg px-3 py-2">Login / Daftar</a>
    @endif
  </nav>
</div>

<!-- Overlay -->
<div id="overlay" aria-hidden="true" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40"></div>

<!-- Scripts -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Client-side resolver for wilayah names (uses public emsifa JSON endpoints)
    async function resolveWilayahClient(provId, kabId, kecId) {
      const result = {};
      try {
        if (provId) {
          const resp = await fetch('https://www.emsifa.com/api-wilayah-indonesia/api/provinces.json');
          if (resp.ok) {
            const provinces = await resp.json();
            const p = provinces.find(x => String(x.id) === String(provId));
            if (p) result.provinsi = p.name;
          }
        }
        if (provId && kabId) {
          const resp2 = await fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/regencies/${provId}.json`);
          if (resp2.ok) {
            const reg = await resp2.json();
            const r = reg.find(x => String(x.id) === String(kabId));
            if (r) result.kabupaten = r.name;
          }
        }
        if (kabId && kecId) {
          const resp3 = await fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/districts/${kabId}.json`);
          if (resp3.ok) {
            const dists = await resp3.json();
            const d = dists.find(x => String(x.id) === String(kecId));
            if (d) result.kecamatan = d.name;
          }
          const resp4 = await fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/villages/${kecId}.json`);
          if (resp4.ok) {
            const vill = await resp4.json();
            // kelurahan id might be included in patient data as kelurahan
            // caller can read vill and match later if needed
            result.villages = vill;
          }
        }
      } catch (e) {
        // ignore network errors
      }
      return result;
    }
    // Dark Mode Toggle
    const toggle = document.getElementById('dark-mode-toggle');
    const html = document.documentElement;
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
      html.classList.add('dark');
      if (toggle) toggle.checked = true;
    }
    if (toggle) {
      toggle.addEventListener('change', () => {
        if (toggle.checked) {
          html.classList.add('dark');
          localStorage.setItem('theme', 'dark');
        } else {
          html.classList.remove('dark');
          localStorage.setItem('theme', 'light');
        }
      });
    }

    // Mobile Menu
    const menuToggle = document.getElementById("menu-toggle");
    const closeMenu = document.getElementById("close-menu");
    const mobileMenu = document.getElementById("mobile-menu");
    const overlay = document.getElementById("overlay");

    // Ensure initial hidden state (in case of missing classes from build)
    if (mobileMenu) mobileMenu.classList.add("-translate-x-full");
    if (overlay) overlay.classList.add("hidden");

    function openSidebar() {
      if (!mobileMenu || !overlay) return;
      mobileMenu.classList.remove("-translate-x-full");
      mobileMenu.setAttribute('aria-hidden', 'false');
      overlay.classList.remove("hidden");
      overlay.setAttribute('aria-hidden', 'false');
    }

    function closeSidebar() {
      if (!mobileMenu || !overlay) return;
      mobileMenu.classList.add("-translate-x-full");
      mobileMenu.setAttribute('aria-hidden', 'true');
      overlay.classList.add("hidden");
      overlay.setAttribute('aria-hidden', 'true');
    }

    if (menuToggle) menuToggle.addEventListener("click", openSidebar);
    if (closeMenu) closeMenu.addEventListener("click", closeSidebar);
    if (overlay) overlay.addEventListener("click", closeSidebar);

    // Account dropdown toggle
    const accountButton = document.getElementById('account-button');
    const accountDropdown = document.getElementById('account-dropdown');
    // whether server session already has resolved wilayah names
    const sessionHasWilayah = {{ json_encode(!empty($u['provinsi_name'] ?? null)) }};
    if (!sessionHasWilayah) {
      (async () => {
        try {
          const res = await fetch("{{ route('api.patient.current') }}", { headers: { 'X-Requested-With': 'XMLHttpRequest' } });
          if (res.ok) {
            const data = await res.json();
            const html = [];
            html.push(`<div class="p-0">`);
            html.push(`<div class="bg-gradient-to-r from-[#2c3e8f] to-[#1a6fb3] text-white rounded-t-lg p-4 flex items-center gap-3">`);
            html.push(`<div class="w-12 h-12 flex-shrink-0 rounded-full bg-white/20 flex items-center justify-center text-lg font-semibold text-white">${(data.nama_lengkap||data.nama||'-').charAt(0).toUpperCase()}</div>`);
            html.push(`<div><div class="font-semibold text-white">${data.nama_lengkap || data.nama || '-'}</div><div class="text-xs text-white/80">No RM: ${data.no_rm || '-'}</div></div>`);
            html.push(`</div>`);
            html.push(`<div class="p-3 text-sm text-gray-700 dark:text-gray-300">`);
            html.push(`<a href="{{ route('pendaftaran-pasien-lama.history') }}" class="block w-full text-center text-gray-800 dark:text-gray-200 bg-gray-100 dark:bg-[#0b1320] hover:bg-gray-200 rounded px-3 py-2 font-medium">Lihat status reservasi</a>`);
            html.push(`</div>`);
            html.push(`<div class="border-t border-gray-100 dark:border-gray-700 p-3">`);
            html.push(`<form action="{{ route('logout') }}" method="POST">@csrf<button type="submit" class="w-full text-center text-white bg-green-600 hover:bg-green-700 px-3 py-2 rounded-md font-semibold">Logout</button></form>`);
            html.push(`</div>`);
            if (accountDropdown) accountDropdown.innerHTML = html.join('');
          }
        } catch (e) {
          // ignore
        }
      })();
    }
    if (accountButton && accountDropdown) {
      accountButton.addEventListener('click', async (e) => {
        e.stopPropagation();
        const isHidden = accountDropdown.classList.contains('hidden');
        if (isHidden) {
          // fetch latest patient data and render into dropdown
          try {
            const res = await fetch("{{ route('api.patient.current') }}", { headers: { 'X-Requested-With': 'XMLHttpRequest' } });
            if (res.ok) {
              const data = await res.json();
              // build minimal html: initial, name, no RM, link to history, logout
              const html = [];
              html.push(`<div class="p-0">`);
              html.push(`<div class="bg-gradient-to-r from-[#2c3e8f] to-[#1a6fb3] text-white rounded-t-lg p-4 flex items-center gap-3">`);
              html.push(`<div class="w-12 h-12 flex-shrink-0 rounded-full bg-white/20 flex items-center justify-center text-lg font-semibold text-white">${(data.nama_lengkap||data.nama||'-').charAt(0).toUpperCase()}</div>`);
              html.push(`<div><div class="font-semibold text-white">${data.nama_lengkap || data.nama || '-'}</div><div class="text-xs text-white/80">No RM: ${data.no_rm || '-'}</div></div>`);
              html.push(`</div>`);
              html.push(`<div class="p-3 text-sm text-gray-700 dark:text-gray-300">`);
              html.push(`<a href="{{ route('pendaftaran-pasien-lama.history') }}" class="block w-full text-center text-gray-800 dark:text-gray-200 bg-gray-100 dark:bg-[#0b1320] hover:bg-gray-200 rounded px-3 py-2 font-medium">Lihat status reservasi</a>`);
              html.push(`</div>`);
              html.push(`<div class="border-t border-gray-100 dark:border-gray-700 p-3">`);
              html.push(`<form action="{{ route('logout') }}" method="POST">@csrf<button type="submit" class="w-full text-center text-white bg-green-600 hover:bg-green-700 px-3 py-2 rounded-md font-semibold">Logout</button></form>`);
              html.push(`</div>`);
              accountDropdown.innerHTML = html.join('');
            } else {
              // keep existing session-rendered content
            }
          } catch (err) {
            console.error('Failed to fetch patient data', err);
          }

          accountDropdown.classList.remove('hidden');
          accountButton.setAttribute('aria-expanded', 'true');
        } else {
          accountDropdown.classList.add('hidden');
          accountButton.setAttribute('aria-expanded', 'false');
        }
      });

      // Close when clicking outside
      document.addEventListener('click', (e) => {
        if (!accountDropdown.contains(e.target) && !accountButton.contains(e.target)) {
          accountDropdown.classList.add('hidden');
          accountButton.setAttribute('aria-expanded', 'false');
        }
      });
    }
  });
</script>
